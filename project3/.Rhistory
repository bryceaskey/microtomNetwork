sum(ref5ref2_expData$pValue_ref5 < 0.05)
sum(Cyp79A2_expData$pValue_ref5 < 0.05)
sum(Cyp79A2_expData$pValue_Cyp79A2 < 0.05)
write.csv(Cyp79A2_expData, file="C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/auxin-response/Cyp79A2_expData.csv", row.names=FALSE)
write.csv(ref5ref2_expData, file="C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/auxin-response/ref5ref2_expData.csv", row.names=FALSE)
log2(1)
log2(2)
log2(0.5)
log2(1.5)
Cyp79A2_expData <- read.csv(file="C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/auxin-response/Cyp79A2_expData.csv")
View(Cyp79A2_expData)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-load-data.R', echo=TRUE)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
sum(Cyp79A2_expData$pValue_Cyp79A2 < 0.05)
sum(Cyp79A2_expData$pValue_ref5 < 0.05)
sum(ref5ref2_expData$pValue_ref5 < 0.05)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
View(Cyp79A2_expData)
View(ref5ref2_expData)
help(merge)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
View(allData)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
allData$short_name == "KFB50"
sum(allData$short_name == "KFB50")
sum(allData$short_name == "At3g59940")
sum(allData$short_name == "AT3G59940")
sum(allData$locus == "AT3G59940")
allData[allData$locus == "AT3G59940", :]
allData[allData$locus == "AT3G59940", ]
allData[allData$locus == "AT2G44130", ]
allData[allData$locus == "At1g15670", ]
allData[allData$locus == "AT1G15670", ]
allData[allData$locus == "AT1G80440", ]
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-load-data.R')
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
length(allData$short_name[allData$pValue_Cyp79A2 < 0.05 & allData$pValue_ref2 < 0.05 & allData$pValue_ref5 < 0.05])
"AT2G44130" %in% allData$locus[allData$pValue_Cyp79A2 < 0.05 & allData$pValue_ref2 < 0.05 & allData$pValue_ref5 < 0.05]
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-load-data.R', echo=TRUE)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
Cyp79A2_expData$locus == "AT2G44130"
Cyp79A2_expData[Cyp79A2_expData$locus == "AT2G44130", ]
log2(1.2)
Cyp79A2_expData <- read.csv(file="C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/auxin-response/Cyp79A2_expData.csv")
View(Cyp79A2_expData)
Cyp79A2_expData[Cyp79A2_expData$locus == "AT2G44130", ]
Cyp79A2_expData[Cyp79A2_expData$locus == "AT1G23390", ]
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
help(par)
sum(Cyp79A2_expData$pValue_Cyp79A2 > 0.05 & Cyp79A2_expData$log2FC_Cyp79A2 > 0)
Cyp79A2_up <- sum(Cyp79A2_expData$pValue_Cyp79A2 > 0.05 & Cyp79A2_expData$log2FC_Cyp79A2 > 0)
Cyp79A2_down <- sum(Cyp79A2_expData$pValue_Cyp79A2 > 0.05 & Cyp79A2_expData$log2FC_Cyp79A2 < 0)
Cyp79A2_up <- sum(Cyp79A2_expData$pValue_Cyp79A2 < 0.05 & Cyp79A2_expData$log2FC_Cyp79A2 > 0)
Cyp79A2_down <- sum(Cyp79A2_expData$pValue_Cyp79A2 < 0.05 & Cyp79A2_expData$log2FC_Cyp79A2 < 0)
Cyp79A2_up <- sum(Cyp79A2_expData$pValue_Cyp79A2 < 0.05 & Cyp79A2_expData$log2FC_Cyp79A2 > 0)
Cyp79A2_down <- sum(Cyp79A2_expData$pValue_Cyp79A2 < 0.05 & Cyp79A2_expData$log2FC_Cyp79A2 < 0)
ref5_up <- sum(ref5ref2_expData$pValue_ref5 < 0.05 & ref5ref2_expData$log2FC_ref5 > 0)
ref5_down <- sum(ref5ref2_expData$pValue_ref5 < 0.05 & ref5ref2_expData$log2FC_ref5 < 0)
ref2_up <- sum(ref5ref2_expData$pValue_ref2 < 0.05 & ref5ref2_expData$log2FC_ref2 > 0)
ref5_down <- sum(ref5ref2_expData$pValue_ref2 < 0.05 & ref5ref2_expData$log2FC_ref2 < 0)
Cyp79A2_up <- sum(Cyp79A2_expData$pValue_Cyp79A2 < 0.05 & Cyp79A2_expData$log2FC_Cyp79A2 > 0)
Cyp79A2_down <- sum(Cyp79A2_expData$pValue_Cyp79A2 < 0.05 & Cyp79A2_expData$log2FC_Cyp79A2 < 0)
ref5_up <- sum(ref5ref2_expData$pValue_ref5 < 0.05 & ref5ref2_expData$log2FC_ref5 > 0)
ref5_down <- sum(ref5ref2_expData$pValue_ref5 < 0.05 & ref5ref2_expData$log2FC_ref5 < 0)
ref2_up <- sum(ref5ref2_expData$pValue_ref2 < 0.05 & ref5ref2_expData$log2FC_ref2 > 0)
ref2_down <- sum(ref5ref2_expData$pValue_ref2 < 0.05 & ref5ref2_expData$log2FC_ref2 < 0)
help(draw.triple.venn)
library(VennDiagram)
help("draw.triple.venn")
Cyp79A2_expData <- subset(Cyp79A2_expData, select=c("locus", "short_name", "aliases", "log2FC_Cyp79A2", "pValue_Cyp79A2"))
ref5ref2_expData <- subset(ref5ref2_expData, select=c("locus", "log2FC_ref5", "pValue_ref5", "log2FC_ref2", "pValue_ref2"))
merged_expData <- merge(Cyp79A2_expData, ref5ref2_expData, by="locus")
merged_expData_up <- merged_expData[merged_expData$log2FC_Cyp79A2 > 0 & merged_expData$log2FC_ref2 > 0 & merged_expData$log2FC_ref5 > 0, ]
View(merged_expData_up)
merged_expData_up <- merged_expData[merged_expData$log2FC_Cyp79A2 > 0 & merged_expData$log2FC_ref2 > 0 & merged_expData$log2FC_ref5 > 0, ]
merged_expData_down <- merged_expData[merged_expData$log2FC_Cyp79A2 < 0 & merged_expData$log2FC_ref2 < 0 & merged_expData$log2FC_ref5 < 0, ]
Cyp79A2_ref5_up <- sum(merged_expData_up$pValue_Cyp79A2 < 0.05 & merged_expData_up$pValue_ref5 < 0.05)
# Calculate intersection counts
Cyp79A2_ref5_up <- sum(merged_expData_up$pValue_Cyp79A2 < 0.05 & merged_expData_up$pValue_ref5 < 0.05)
Cyp79A2_ref2_up <- sum(merged_expData_up$pValue_Cyp79A2 < 0.05 & merged_expData_up$pValue_ref2 < 0.05)
ref5_ref2_up <- sum(merged_expData_up$pValue_ref5 < 0.05 & merged_expData_up$pValue_ref2 < 0.05)
Cyp79A2_ref5_down <- sum(merged_expData_down$pValue_Cyp79A2 < 0.05 & merged_expData_down$pValue_ref5 < 0.05)
Cyp79A2_ref2_down <- sum(merged_expData_down$pValue_Cyp79A2 < 0.05 & merged_expData_down$pValue_ref2 < 0.05)
ref5_ref2_down <- sum(merged_expData_down$pValue_ref5 < 0.05 & merged_expData_down$pValue_ref2 < 0.05)
Cyp79A2_ref5_ref2_up <- sum(merged_expData_up$pValue_Cyp79A2 < 0.05 & merged_expData_up$pValue_ref5 < 0.05 & merged_expData_up$pValue_ref2 < 0.05)
Cyp79A2_ref5_ref2_down <- sum(merged_expData_down$pValue_Cyp79A2 < 0.05 & merged_expData_down$pValue_ref5 < 0.05 & merged_expData_down$pValue_ref2 < 0.05)
draw.triple.venn(
area1=Cyp79A2_up,
area2=ref5_up,
area3=ref2_up,
n12=Cyp79A2_ref5_up,
n13=Cyp79A2_ref2_up,
n23=ref5_ref2_up,
n123=Cyp79A2_ref5_ref2_up,
category=c("79A2_up", "ref5_up", "ref2_up"),
cat.fontfamily="sans",
cat.cex=rep(2, 3),
cat.dist=rep(0.085, 3),
lty="blank",
fontfamily="sans",
cex=rep(2, 7),
fill=c("skyblue", "pink1", "mediumorchid"),
mar=0.075,
)
par(mfrow = c(1, 2))
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
install.packages("extrafont")
library(extrafont)
font_import()
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
warnings()
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
warnings()
fonts()
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
library(tidyverse)
library(extrafont)
Cyp79A2_expData <- read.csv(file="C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/auxin-response/Cyp79A2_expData.csv")
ref5ref2_expData <- read.csv(file="C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/auxin-response/ref5ref2_expData.csv")
# Merge data for calculation of intersect counts
Cyp79A2_expData <- subset(Cyp79A2_expData, select=c("locus", "short_name", "aliases", "log2FC_Cyp79A2", "pValue_Cyp79A2"))
ref5ref2_expData <- subset(ref5ref2_expData, select=c("locus", "log2FC_ref5", "pValue_ref5", "log2FC_ref2", "pValue_ref2"))
merged_expData <- merge(Cyp79A2_expData, ref5ref2_expData, by="locus")
merged_expData_up <- merged_expData[merged_expData$log2FC_Cyp79A2 > 0 & merged_expData$log2FC_ref2 > 0 & merged_expData$log2FC_ref5 > 0, ]
merged_expData_down <- merged_expData[merged_expData$log2FC_Cyp79A2 < 0 & merged_expData$log2FC_ref2 < 0 & merged_expData$log2FC_ref5 < 0, ]
Cyp79A2_ref5_ref2_up <- merged_expData_up[merged_expData_up$pValue_Cyp79A2 < 0.05 & merged_expData_up$pValue_ref5 < 0.05 & merged_expData_up$pValue_ref2 < 0.05, ]
Cyp79A2_ref5_ref2_down <- merged_expData_down[merged_expData_down$pValue_Cyp79A2 < 0.05 & merged_expData_down$pValue_ref5 < 0.05 & merged_expData_down$pValue_ref2 < 0.05, ]
View(Cyp79A2_ref5_ref2_up)
"AT1G15670" %in% Cyp79A2_ref5_ref2_up$locus
"AT1G80440" %in% Cyp79A2_ref5_ref2_up$locus
"AT2G44130" %in% Cyp79A2_ref5_ref2_up$locus
"AT2G44130" %in% Cyp79A2_ref5_ref2_up$locus
"AT3G59940" %in% Cyp79A2_ref5_ref2_up$locus
"AT1G55270" %in% Cyp79A2_ref5_ref2_up$locus
"AT1G23390" %in% Cyp79A2_ref5_ref2_up$locus
merged_expData[merged_expData$locus == "AT1G23390", ]
library(edgeR)
help("filterByExpr")
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-load-data.R', echo=TRUE)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-load-data.R')
View(Cyp79A2_expData)
# Export data as .csv
write.csv(Cyp79A2_expData, file="C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/auxin-response/Cyp79A2_expData.csv", row.names=FALSE)
write.csv(ref5ref2_expData, file="C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/auxin-response/ref5ref2_expData.csv", row.names=FALSE)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R', echo=TRUE)
library(edgeR)
help(filterbyExpr)
help(filterByExpr)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-load-data.R', echo=TRUE)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-venn-diagrams.R')
Cyp79A2_expData <- read.csv(file="C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/auxin-response/Cyp79A2_expData.csv")
sum(Cyp79A2_expData$pValue_Cyp79A2 < 0.05 & Cyp79A2_expData$log2FC_Cyp79A2 > 0)
sum(Cyp79A2_expData$pValue_Cyp79A2 < 0.05 & Cyp79A2_expData$log2FC_Cyp79A2 < 0)
View(Cyp79A2_expData)
log2(1.2)
ref5ref2_expData <- read.csv(file="C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/auxin-response/ref5ref2_expData.csv")
Cyp79A2_expData <- subset(Cyp79A2_expData, select=c("locus", "short_name", "aliases", "log2FC_Cyp79A2", "pValue_Cyp79A2"))
ref5ref2_expData <- subset(ref5ref2_expData, select=c("locus", "log2FC_ref5", "pValue_ref5", "log2FC_ref2", "pValue_ref2"))
merged_expData <- merge(Cyp79A2_expData, ref5ref2_expData, by="locus")
merged_expData_up <- merged_expData[merged_expData$log2FC_Cyp79A2 > 0 & merged_expData$log2FC_ref2 > 0 & merged_expData$log2FC_ref5 > 0, ]
merged_expData_down <- merged_expData[merged_expData$log2FC_Cyp79A2 < 0 & merged_expData$log2FC_ref2 < 0 & merged_expData$log2FC_ref5 < 0, ]
View(merged_expData)
View(merged_expData_up)
library(tidyr)
library(tidyverse)
Cyp79A2_expData <- read.csv(file="C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/auxin-response/Cyp79A2_expData.csv")
View(Cyp79A2_expData)
Cyp79A2_DEGs <- filter(Cyp79A2_expData, pValue_Cyp79A2 < 0.05)
View(Cyp79A2_DEGs)
write.csv(Cyp79A2_DEGs, file="C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/auxin-response/Cyp79A2_DEGs.csv", row.names=FALSE)
intersectAll_up <- merged_expData_up[merged_expData_up$pValue_Cyp79A2 < 0.05 & merged_expData_up$pValue_ref5 < 0.05 & merged_expData_up$pValue_ref2 < 0.05, ]
intersectAll_down <- merged_expData_down[merged_expData_down$pValue_Cyp79A2 < 0.05 & merged_expData_down$pValue_ref5 < 0.05 & merged_expData_down$pValue_ref2 < 0.05, ]
View(intersectAll_up)
Cyp79A2_expData <- read.csv(file="C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/auxin-response/Cyp79A2_expData.csv")
ref5ref2_expData <- read.csv(file="C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/auxin-response/ref5ref2_expData.csv")
View(Cyp79A2_expData)
Cyp79A2_expData <- read.csv(file="C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/auxin-response/Cyp79A2_expData.csv")
ref5ref2_expData <- read.csv(file="C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/auxin-response/ref5ref2_expData.csv")
View(Cyp79A2_expData)
colnames(Cyp79A2_expData)[6:ncol(Cyp79A2_expData)]
View(Cyp79A2_expData)
colnames(Cyp79A2_expData)[6:ncol(Cyp79A2_expData)] <- colnames(Cyp79A2_expData)[6:ncol(Cyp79A2_expData)] + "_A"
# Merge data for calculation of intersect counts
colnames(Cyp79A2_expData)[6:ncol(Cyp79A2_expData)] <- paste(colnames(Cyp79A2_expData)[6:ncol(Cyp79A2_expData)], "_A")
View(Cyp79A2_expData)
colnames(Cyp79A2_expData)
Cyp79A2_expData <- read.csv(file="C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/auxin-response/Cyp79A2_expData.csv")
ref5ref2_expData <- read.csv(file="C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/auxin-response/ref5ref2_expData.csv")
# Merge data for calculation of intersect counts
colnames(Cyp79A2_expData)[6:ncol(Cyp79A2_expData)] <- paste(colnames(Cyp79A2_expData)[6:ncol(Cyp79A2_expData)], "_A", sep="")
View(Cyp79A2_expData)
library(tidyverse)
Cyp79A2_expData <- read.csv(file="C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/auxin-response/Cyp79A2_expData.csv")
ref5ref2_expData <- read.csv(file="C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/auxin-response/ref5ref2_expData.csv")
# Merge data for calculation of intersect counts
colnames(Cyp79A2_expData)[6:ncol(Cyp79A2_expData)] <- paste(colnames(Cyp79A2_expData)[6:ncol(Cyp79A2_expData)], "_A", sep="")
colnames(ref5ref2_expData)[6:ncol(ref5ref2_expData)] <- paste(colnames(ref5ref2_expData)[6:ncol(ref5ref2_expData)], "_B", sep="")
merged_expData <- merge(Cyp79A2_expData, ref5ref2_expData, by="locus")
View(merged_expData)
library(tidyverse)
Cyp79A2_expData <- read.csv(file="C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/auxin-response/Cyp79A2_expData.csv")
ref5ref2_expData <- read.csv(file="C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/auxin-response/ref5ref2_expData.csv")
# Merge data for calculation of intersect counts
colnames(Cyp79A2_expData)[6:ncol(Cyp79A2_expData)] <- paste(colnames(Cyp79A2_expData)[6:ncol(Cyp79A2_expData)], "_A", sep="")
colnames(ref5ref2_expData)[6:ncol(ref5ref2_expData)] <- paste(colnames(ref5ref2_expData)[6:ncol(ref5ref2_expData)], "_B",)
ref5ref2_expData <- subset(ref5ref2_expData, select=c(1, 6:ncol(ref5ref2_expData)))
Cyp79A2_expData <- read.csv(file="C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/auxin-response/Cyp79A2_expData.csv")
ref5ref2_expData <- read.csv(file="C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/auxin-response/ref5ref2_expData.csv")
# Merge data for calculation of intersect counts
colnames(Cyp79A2_expData)[6:ncol(Cyp79A2_expData)] <- paste(colnames(Cyp79A2_expData)[6:ncol(Cyp79A2_expData)], "_A", sep="")
colnames(ref5ref2_expData)[6:ncol(ref5ref2_expData)] <- paste(colnames(ref5ref2_expData)[6:ncol(ref5ref2_expData)], "_B", sep="")
ref5ref2_expData <- subset(ref5ref2_expData, select=c(1, 6:ncol(ref5ref2_expData)))
View(merged_expData)
View(ref5ref2_expData)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-DEG-lists.R', echo=TRUE)
View(merged_expData_up)
intersect_DEGs_up <- merged_expData_up[merged_expData_up$pValue_Cyp79A2_A < 0.05 & merged_expData_up$pValue_ref2_B < 0.05 & merged_expData_up$pValue_ref5_B < 0.05, ]
View(merged_expData)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-DEG-lists.R', echo=TRUE)
View(merged_expData_up)
intersect_DEGs_up <- merged_expData_up[merged_expData_up$pValue_Cyp79A2_A < 0.05 & merged_expData_up$pValue_ref2_B < 0.05 & merged_expData_up$pValue_ref5_B < 0.05, ]
intersect_DEGs_down <- merged_expData_down[merged_expData_down$pValue_Cyp79A2_A < 0.05 & merged_expData_down$pValue_ref2_B < 0.05 & merged_expData_down$pValue_ref5_B < 0.05]
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-DEG-lists.R', echo=TRUE)
View(intersect_DEGs_up)
write.csv(intersect_DEGs_up, file="C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/auxin-response/intersect_DEGs_up.csv", row.names=FALSE)
write.csv(intersect_DEGs_down, file="C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/auxin-response/intersect_DEGs_down.csv", row.names=FALSE)
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-graphs.R')
source('~/Cyp79A2-RNAseq/R-scripts/auxin-response-graphs.R')
View(plotData)
source('~/scutellariaMetabolites/code/stackedBarPlots.R', echo=TRUE)
source('~/scutellariaMetabolites/code/stackedBarPlots.R', echo=TRUE)
print(plot_grid(legend), nrow=1, ncol=1)
dev.off()
dev.off()
dev.off()
dev.off()
print(plot_grid(legend), nrow=1, ncol=1)
print(plot_grid(legend), nrow=1, ncol=1)
rawData <- read.csv(file="C:/Users/bca08_000/Documents/scutellariaMetabolites/data/20201119_suffrutescens.csv", header=TRUE)
View(rawData)
# Define function to interpret injection organ ----
getSampleOrgan <- function(injectionName){
organAbbrev <- strsplit(strsplit(injectionName, split="_")[[1]][2], split="-")[[1]][1]
sampleOrgan <-
if(organAbbrev=="L"){
sampleOrgan <- "leaves"
}else if(organAbbrev=="S"){
sampleOrgan <- "shoots"
}else if(organAbbrev=="R"){
sampleOrgan <- "roots"
}else{
sampleOrgan <- NA
}
return(as.character(sampleOrgan))
}
getSampleOrgan(rawData$injectionName[1])
# Define function to interpret injection organ ----
getSampleOrgan <- function(injectionName){
organAbbrev <- strsplit(strsplit(injectionName, split="_")[[1]][2], split="-")[[1]][1]
if(organAbbrev=="L"){
sampleOrgan <- "leaves"
}else if(organAbbrev=="S"){
sampleOrgan <- "shoots"
}else if(organAbbrev=="R"){
sampleOrgan <- "roots"
}else{
sampleOrgan <- NA
}
return(as.character(sampleOrgan))
}
getSampleOrgan(rawData$injectionName[1])
strsplit(strsplit(rawData$injectionName[0], split="_")[[1]][2], split="-")[[1]][1]
strsplit(strsplit(rawData$injectionName[1], split="_")[[1]][2], split="-")[[1]][1]
strsplit(strsplit(rawData$injectionName[3], split="_")[[1]][2], split="-")[[1]][1]
strsplit(strsplit(rawData$injectionName[5], split="_")[[1]][2], split="-")[[1]][1]
strsplit(strsplit(rawData$injectionName[8], split="_")[[1]][2], split="-")[[1]][1]
strsplit(strsplit(rawData$injectionName[20], split="_")[[1]][2], split="-")[[1]][1]
strsplit(strsplit(rawData$injectionName[24], split="_")[[1]][2], split="-")[[1]][1]
# Define function to interpret injection organ ----
getSampleOrgan <- function(injectionName){
organAbbrev <- strsplit(strsplit(injectionName, split="_")[[1]][2], split="-")[[1]][1]
if(organAbbrev=="L"){
sampleOrgan <- "leaves"
}else if(organAbbrev=="S"){
sampleOrgan <- "shoots"
}else if(organAbbrev=="R"){
sampleOrgan <- "roots"
}else{
sampleOrgan <- NA
}
return(as.character(sampleOrgan))
}
getSampleOrgan(rawData$injectionName[24])
getSampleOrgan(rawData$injectionName[0])
View(rawData)
rawData <- read.csv(file="C:/Users/bca08_000/Documents/scutellariaMetabolites/data/20201119_suffrutescens.csv", header=TRUE)
View(rawData)
source('~/scutellariaMetabolites/code/dataPreprocessingSuffrutescens.R', echo=TRUE)
source('~/scutellariaMetabolites/code/dataPreprocessingSuffrutescens.R', echo=TRUE)
View(sufData)
source('~/scutellariaMetabolites/code/dataPreprocessingSuffrutescens.R', echo=TRUE)
source('~/scutellariaMetabolites/code/dataPreprocessingSuffrutescens.R', echo=TRUE)
source('~/scutellariaMetabolites/code/dataPreprocessingSuffrutescens.R', echo=TRUE)
suffrutescens <- read.csv("C:/Users/bca08_000/Documents/scutellariaMetabolites/data/preprocessed/20201119_suffrutescens.csv")[, 2:6]
View(suffrutescens)
library(dplyr)
library(ggplot2)
library(ggrepel)
library(cowplot)
# Load data from .csv files
fresh <- read.csv("C:/Users/bca08_000/Documents/scutellariaMetabolites/data/preprocessed/20190813_fresh.csv")[, 2:6]
frozenKR <- read.csv("C:/Users/bca08_000/Documents/scutellariaMetabolites/data/preprocessed/20200117_frozenKR.csv")[, 2:6]
wrightii <- read.csv("C:/Users/bca08_000/Documents/scutellariaMetabolites/data/preprocessed/20201007_wrightii.csv")[, 2:6]
suffrutescens <- read.csv("C:/Users/bca08_000/Documents/scutellariaMetabolites/data/preprocessed/20201119_suffrutescens.csv")[, 2:6]
cladeData <- read.csv("C:/Users/bca08_000/Documents/scutellariaMetabolites/data/phylo-tree-clades.csv")
# Remove barbata from fresh data - use only KR data
fresh <- fresh %>%
filter(!grepl("barbata", species))
# Combine all data into a single data frame and change classifiers (species, organs, metabolites)
# into factors
allData <- rbind(fresh, frozenKR, wrightii, suffrutescens)
allData$species <- as.factor(allData$species)
allData$organ <- as.factor(allData$organ)
allData$metabolite <- as.factor(allData$metabolite)
# Specify any species, organs, or metabolites to exclude, and remove from data frame
excludeSpecies <- paste(c("racemosa 071119", "racemosa MS", "racemosa SC", "hastafolia", "hastifolia", "arenicola", "havenesis"), collapse = '|')
excludeOrgans <- paste(c("flowers"), collapse = '|')
# excludeMetabolites <- paste(c(), collapse = '|')
allData <- allData %>%
filter(!grepl(excludeSpecies, species)) %>%
filter(!grepl(excludeOrgans, organ)) #>%>
# filter(!grepl(excludeMetabolites, metabolites))
# Fix naming errors
allData$species <- as.character(allData$species)
allData$species[allData$species=="RNA Seq"] <- "racemosa"
allData$species[allData$species=="havenesis"] <- "havanensis"
allData$species[allData$species=="hastafolia"] <- "hastifolia"
allData$species[allData$species=="pekinesis"] <- "pekinensis var. alpina"
allData$species[allData$species=="indica"] <- "indica var. coccinea"
allData$species <- as.factor(allData$species)
# Average together any duplicate data points
allData <- allData %>%
group_by(species, organ, metabolite) %>%
summarise(concentration_ppm=mean(concentration_ppm), stError_ppm=mean(stError_ppm)) %>%
ungroup()
# Adjust fresh ppm to correct for dilution
# Data is saved at 5000 ppm. Divide by 5 to calculate at 1000 ppm (= umol/1 g FW)
allData <- allData %>%
transmute(
species=species,
organ=organ,
metabolite=metabolite,
concentration_ppm=concentration_ppm/5,
stError_ppm=stError_ppm/5
)
# Define function to convert units of ppm to micromol/L
ppm2microM <- function(input_ppm, metaboliteName){
if(!is.na(input_ppm)){
if(metaboliteName=="acetoside"){ #PubChem CID: 5281800
output_microM <- (input_ppm/624.6)*1000
}else if(metaboliteName=="apigenin"){ #PubChem CID: 5280443
output_microM <- (input_ppm/270.24)*1000
}else if(metaboliteName=="apigeninG"){ #PubChem CID: 5280704
output_microM <- (input_ppm/432.4)*1000
}else if(metaboliteName=="baicalein"){ #PubChem CID: 5281605
output_microM <- (input_ppm/270.24)*1000
}else if(metaboliteName=="baicalin"){ #PubChem CID: 64982
output_microM <- (input_ppm/446.4)*1000
}else if(metaboliteName=="chrysin"){ #PubChem CID: 5281607
output_microM <- (input_ppm/254.24)*1000
}else if(metaboliteName=="chrysinG"){ #PubChem CID: 90658886
output_microM <- (input_ppm/416.4)*1000
}else if(metaboliteName=="hispidulin"){ #PubChem CID: 5281628
output_microM <- (input_ppm/300.26)*1000
}else if(metaboliteName=="hispidulinG"){ #PubChem CID: 5318083
output_microM <- (input_ppm/462.4)*1000
}else if(metaboliteName=="oroxylinA"){ #PubChem CID: 5320315
output_microM <- (input_ppm/284.26)*1000
}else if(metaboliteName=="oroxyloside"){ #PubChem CID: 14655551
output_microM <- (input_ppm/460.4)*1000
}else if(metaboliteName=="scutellarein"){ #PubChem CID: 5281697
output_microM <- (input_ppm/286.24)*1000
}else if(metaboliteName=="scutellarin"){ #PubChem CID: 185617
output_microM <- (input_ppm/462.4)*1000
}else if(metaboliteName=="wogonin"){ #PubChem CID: 5281703
output_microM <- (input_ppm/284.26)*1000
}else if(metaboliteName=="wogonoside"){ #PubChem CID: 3084961
output_microM <- (input_ppm/460.4)*1000
}else{
print(paste("Error: metabolite name", metaboliteName,  "not recognized"))
output_microM <- NA
}
}else{
output_microM <- NA
}
return(output_microM)
}
View(allData)
library(dplyr)
library(ggplot2)
library(ggrepel)
library(cowplot)
# Load data from .csv files
fresh <- read.csv("C:/Users/bca08_000/Documents/scutellariaMetabolites/data/preprocessed/20190813_fresh.csv")[, 2:6]
frozenKR <- read.csv("C:/Users/bca08_000/Documents/scutellariaMetabolites/data/preprocessed/20200117_frozenKR.csv")[, 2:6]
wrightii <- read.csv("C:/Users/bca08_000/Documents/scutellariaMetabolites/data/preprocessed/20201007_wrightii.csv")[, 2:6]
suffrutescens <- read.csv("C:/Users/bca08_000/Documents/scutellariaMetabolites/data/preprocessed/20201119_suffrutescens.csv")[, 2:6]
cladeData <- read.csv("C:/Users/bca08_000/Documents/scutellariaMetabolites/data/phylo-tree-clades.csv")
# Remove barbata from fresh data - use only KR data
fresh <- fresh %>%
filter(!grepl("barbata", species))
# Combine all data into a single data frame and change classifiers (species, organs, metabolites)
# into factors
allData <- rbind(fresh, frozenKR, wrightii, suffrutescens)
allData$species <- as.factor(allData$species)
allData$organ <- as.factor(allData$organ)
allData$metabolite <- as.factor(allData$metabolite)
# Specify any species, organs, or metabolites to exclude, and remove from data frame
excludeSpecies <- paste(c("racemosa 071119", "racemosa MS", "racemosa SC", "hastafolia", "hastifolia", "arenicola", "havenesis"), collapse = '|')
excludeOrgans <- paste(c("flowers"), collapse = '|')
# excludeMetabolites <- paste(c(), collapse = '|')
allData <- allData %>%
filter(!grepl(excludeSpecies, species)) %>%
filter(!grepl(excludeOrgans, organ)) #>%>
# filter(!grepl(excludeMetabolites, metabolites))
# Fix naming errors
allData$species <- as.character(allData$species)
allData$species[allData$species=="RNA Seq"] <- "racemosa"
allData$species[allData$species=="havenesis"] <- "havanensis"
allData$species[allData$species=="hastafolia"] <- "hastifolia"
allData$species[allData$species=="pekinesis"] <- "pekinensis var. alpina"
allData$species[allData$species=="indica"] <- "indica var. coccinea"
allData$species <- as.factor(allData$species)
# Average together any duplicate data points
allData <- allData %>%
group_by(species, organ, metabolite) %>%
summarise(concentration_ppm=mean(concentration_ppm), stError_ppm=mean(stError_ppm)) %>%
ungroup()
# Adjust fresh ppm to correct for dilution
# Data is saved at 5000 ppm. Divide by 5 to calculate at 1000 ppm (= umol/1 g FW)
allData <- allData %>%
transmute(
species=species,
organ=organ,
metabolite=metabolite,
concentration_ppm=concentration_ppm/5,
stError_ppm=stError_ppm/5
)
# Define function to convert units of ppm to micromol/L
ppm2microM <- function(input_ppm, metaboliteName){
if(!is.na(input_ppm)){
if(metaboliteName=="acetoside"){ #PubChem CID: 5281800
output_microM <- (input_ppm/624.6)*1000
}else if(metaboliteName=="apigenin"){ #PubChem CID: 5280443
output_microM <- (input_ppm/270.24)*1000
}else if(metaboliteName=="apigeninG"){ #PubChem CID: 5280704
output_microM <- (input_ppm/432.4)*1000
}else if(metaboliteName=="baicalein"){ #PubChem CID: 5281605
output_microM <- (input_ppm/270.24)*1000
}else if(metaboliteName=="baicalin"){ #PubChem CID: 64982
output_microM <- (input_ppm/446.4)*1000
}else if(metaboliteName=="chrysin"){ #PubChem CID: 5281607
output_microM <- (input_ppm/254.24)*1000
}else if(metaboliteName=="chrysinG"){ #PubChem CID: 90658886
output_microM <- (input_ppm/416.4)*1000
}else if(metaboliteName=="hispidulin"){ #PubChem CID: 5281628
output_microM <- (input_ppm/300.26)*1000
}else if(metaboliteName=="hispidulinG"){ #PubChem CID: 5318083
output_microM <- (input_ppm/462.4)*1000
}else if(metaboliteName=="oroxylinA"){ #PubChem CID: 5320315
output_microM <- (input_ppm/284.26)*1000
}else if(metaboliteName=="oroxyloside"){ #PubChem CID: 14655551
output_microM <- (input_ppm/460.4)*1000
}else if(metaboliteName=="scutellarein"){ #PubChem CID: 5281697
output_microM <- (input_ppm/286.24)*1000
}else if(metaboliteName=="scutellarin"){ #PubChem CID: 185617
output_microM <- (input_ppm/462.4)*1000
}else if(metaboliteName=="wogonin"){ #PubChem CID: 5281703
output_microM <- (input_ppm/284.26)*1000
}else if(metaboliteName=="wogonoside"){ #PubChem CID: 3084961
output_microM <- (input_ppm/460.4)*1000
}else{
print(paste("Error: metabolite name", metaboliteName,  "not recognized"))
output_microM <- NA
}
}else{
output_microM <- NA
}
return(output_microM)
}
View(allData)
source('~/scutellariaMetabolites/code/stackedBarPlots.R', echo=TRUE)
source('~/Classes/ABE4662/project3/project3_drawNetwork.R', echo=TRUE)
